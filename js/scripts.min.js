// ================================
// ========== javascript ==========

//humburger

let hamburger = document.querySelector('.header__hamburger');
let mobile_menu = document.querySelector('.header-mobile');
let mobile_background = document.querySelector('.header-mobile__background');
let hamburger_close = document.querySelector('.header-mobile__close');
let body = document.querySelector('body');
const toggleMenu = () => {
    mobile_menu.classList.toggle('header-mobile--active');
    hamburger.classList.toggle('hamburger-close');
    mobile_background.classList.toggle('header-mobile__background--active');
    body.classList.toggle('overflow-hidden');
}
hamburger_close.addEventListener('click', e => {
    e.stopPropagation();
    toggleMenu();
});
hamburger.addEventListener('click', e => {
    e.stopPropagation();
    toggleMenu();
});
document.addEventListener('click', e => {
    let target = e.target;
    let its_mobile_menu = target == mobile_menu || mobile_menu.contains(target);
    let its_hamburger = target == hamburger;
    let mobile_menu_is_active = mobile_menu.classList.contains('header-mobile--active');

    if (!its_mobile_menu && !its_hamburger && mobile_menu_is_active) {
        toggleMenu();
    }
})
//--------

//youtube для iframe-full-video__section
var players = [];
var playButtons = document.querySelectorAll(".js--youtube-iframe-play-button");
var playButtons_text_top = document.querySelectorAll(".iframe-full-video__text-top");
var playButtons_text_bottom = document.querySelectorAll(".iframe-full-video__text-bottom");
function onYouTubeIframeAPIReady() {
    var iframes = document.querySelectorAll(".js--youtube-iframe");
    for (var i = 0; i < iframes.length; i++) {
        var player = new YT.Player(iframes[i], {
            events: {
                'onReady': onPlayerReady(i),
                'onStateChange': onPlayerStateChange(i)
            }
        });
        players.push(player);
    }
}
function onPlayerReady(index) {
    return function(event) {
        playButtons[index].addEventListener("click", function() {
            players[index].playVideo();
        });
    }
}
function onPlayerStateChange(index) {
    return function(event) {
        if (event.data == YT.PlayerState.PLAYING) {
            //скрываем
            playButtons[index].style.display = 'none';
            playButtons_text_top[index].style.display = 'none';
            playButtons_text_bottom[index].style.display = 'none';
        }
        // if (event.data == YT.PlayerState.ENDED || event.data == YT.PlayerState.PAUSED) {
        //     //показываем при паузе
        //     playButtons[index].style.display = 'block';
        //     playButtons_text_top[index].style.display = 'flex';
        //     playButtons_text_bottom[index].style.display = 'flex';
        // }
    }
}
//---------

//fancybox
Fancybox.bind("[data-fancybox]", {
    // Your custom options
});




// ==================================
// ==================================
// ============= jQuery =============
jQuery(document).ready(function ($) {

    // header-mobile menu
    $('.header-mobile__menu .header-menu > .menu-item.menu-item-has-children').on('click', function (item) {
        console.log(item.target.className);
        if (item.target.className === 'menu-item menu-item-has-children') { //По 1 лвл
            $(this).toggleClass('open');
        } else if (item.target.className === 'menu-item menu-item-has-children open') {
            $(this).toggleClass('open');
        }
    });
    $('.header-mobile__menu .header-menu > .menu-item.menu-item-has-children > .sub-menu > .menu-item.menu-item-has-children').on('click', function (item) {
        console.log(item.target.className);
        if (item.target.className === 'menu-item menu-item_lvl-2 menu-item-has-children') { //По 1 лвл
            $(this).toggleClass('open');
        } else if (item.target.className === 'menu-item menu-item_lvl-2 menu-item-has-children open') {
            $(this).toggleClass('open');
        }
    });
    //---------

    //flex-partners__item__links__item--last
    $('.flex-partners__item__links__item--last').on('click', function () {
        $(this).parent('.flex-partners__item__links').removeClass('items-hide');
        $(this).remove();
    })
    //---------

    //sliders
    $('.slider-default--cert').owlCarousel({
        loop: true,
        // items:5,
        autoWidth: true,
        margin:12,
        center:true,
        nav:true,
        navText: ['<svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44" fill="none">\n' +
        '<rect width="44" height="44" rx="22" fill="#EB6025"/>\n' +
        '<path fill-rule="evenodd" clip-rule="evenodd" d="M16.5633 23.025C15.9834 22.4539 15.9834 21.5279 16.5633 20.9568L23.1922 14.4283C23.7721 13.8572 24.7122 13.8572 25.2921 14.4283C25.872 14.9994 25.872 15.9254 25.2921 16.4965L19.7132 21.9909L25.2921 27.4853C25.872 28.0564 25.872 28.9824 25.2921 29.5535C24.7122 30.1246 23.7721 30.1246 23.1922 29.5535L16.5633 23.025Z" fill="white"/>\n' +
        '</svg>', '<svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44" fill="none">\n' +
        '<rect width="44" height="44" rx="22" transform="matrix(-1 0 0 1 44 0)" fill="#EB6025"/>\n' +
        '<path fill-rule="evenodd" clip-rule="evenodd" d="M27.4367 23.025C28.0166 22.4539 28.0166 21.5279 27.4367 20.9568L20.8078 14.4283C20.2279 13.8572 19.2878 13.8572 18.7079 14.4283C18.128 14.9994 18.128 15.9254 18.7079 16.4965L24.2868 21.9909L18.7079 27.4853C18.128 28.0564 18.128 28.9824 18.7079 29.5535C19.2878 30.1246 20.2279 30.1246 20.8078 29.5535L27.4367 23.025Z" fill="white"/>\n' +
        '</svg>'],
    });


    $('.slider-logos').owlCarousel({
        loop: true,
        items:5,
        // autoWidth: true,
        margin:38,
        center:true,
        nav:true,
        navText: ['<svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44" fill="none">\n' +
        '<rect width="44" height="44" rx="22" fill="#EB6025"/>\n' +
        '<path fill-rule="evenodd" clip-rule="evenodd" d="M16.5633 23.025C15.9834 22.4539 15.9834 21.5279 16.5633 20.9568L23.1922 14.4283C23.7721 13.8572 24.7122 13.8572 25.2921 14.4283C25.872 14.9994 25.872 15.9254 25.2921 16.4965L19.7132 21.9909L25.2921 27.4853C25.872 28.0564 25.872 28.9824 25.2921 29.5535C24.7122 30.1246 23.7721 30.1246 23.1922 29.5535L16.5633 23.025Z" fill="white"/>\n' +
        '</svg>', '<svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44" fill="none">\n' +
        '<rect width="44" height="44" rx="22" transform="matrix(-1 0 0 1 44 0)" fill="#EB6025"/>\n' +
        '<path fill-rule="evenodd" clip-rule="evenodd" d="M27.4367 23.025C28.0166 22.4539 28.0166 21.5279 27.4367 20.9568L20.8078 14.4283C20.2279 13.8572 19.2878 13.8572 18.7079 14.4283C18.128 14.9994 18.128 15.9254 18.7079 16.4965L24.2868 21.9909L18.7079 27.4853C18.128 28.0564 18.128 28.9824 18.7079 29.5535C19.2878 30.1246 20.2279 30.1246 20.8078 29.5535L27.4367 23.025Z" fill="white"/>\n' +
        '</svg>'],
        responsive: {
            0: {
                items:3,
                margin:2,
                center: true,
                startPosition: 1,
            },
            481: {
                items:4,
                margin:12,
                center: true,
                startPosition: 1,
            },
            801: {
                items:4,
                margin:12,
                center: false,
            },
            1071: {
                items:4,
                margin:12,
                center: false,
            },
            1261: {
                items:5,
                margin:24,
                center: true,
            }
        }
    });

    $('.block-text-slider__slider').owlCarousel({
        loop: false,
        items:3,
        autoWidth: true,
        margin:8,
        // center:false,
        dots:false,
        nav:true,
        navText: ['<svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44" fill="none">\n' +
        '<rect width="44" height="44" rx="22" fill="#EB6025"/>\n' +
        '<path fill-rule="evenodd" clip-rule="evenodd" d="M16.5633 23.025C15.9834 22.4539 15.9834 21.5279 16.5633 20.9568L23.1922 14.4283C23.7721 13.8572 24.7122 13.8572 25.2921 14.4283C25.872 14.9994 25.872 15.9254 25.2921 16.4965L19.7132 21.9909L25.2921 27.4853C25.872 28.0564 25.872 28.9824 25.2921 29.5535C24.7122 30.1246 23.7721 30.1246 23.1922 29.5535L16.5633 23.025Z" fill="white"/>\n' +
        '</svg>', '<svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44" fill="none">\n' +
        '<rect width="44" height="44" rx="22" transform="matrix(-1 0 0 1 44 0)" fill="#EB6025"/>\n' +
        '<path fill-rule="evenodd" clip-rule="evenodd" d="M27.4367 23.025C28.0166 22.4539 28.0166 21.5279 27.4367 20.9568L20.8078 14.4283C20.2279 13.8572 19.2878 13.8572 18.7079 14.4283C18.128 14.9994 18.128 15.9254 18.7079 16.4965L24.2868 21.9909L18.7079 27.4853C18.128 28.0564 18.128 28.9824 18.7079 29.5535C19.2878 30.1246 20.2279 30.1246 20.8078 29.5535L27.4367 23.025Z" fill="white"/>\n' +
        '</svg>'],
        responsive: {
            0: {
                items:2,
            },
            881: {
                items:3,
            },
            1201: {
                items:3,
            }
        }
    });

    $('.blog-slider').owlCarousel({
        loop: false,
        autoWidth: true,
        margin:24,
        nav:false,
        center: true,
        responsive: {
            0: {
                margin:12,
                center: true,
                startPosition: 1,
            },
            461: {
                margin:12,
                center: false,
            },
            1121: {
                margin:24,
                center: false,
            },
            1261: {
                margin:24,
                center: true,
            }
        }
    });

    $('.review-slider').owlCarousel({
        loop: false,
        autoWidth: true,
        margin:24,
        center: true,
        nav:false,
        navText: ['<svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44" fill="none">\n' +
        '<rect width="44" height="44" rx="22" fill="#EB6025"/>\n' +
        '<path fill-rule="evenodd" clip-rule="evenodd" d="M16.5633 23.025C15.9834 22.4539 15.9834 21.5279 16.5633 20.9568L23.1922 14.4283C23.7721 13.8572 24.7122 13.8572 25.2921 14.4283C25.872 14.9994 25.872 15.9254 25.2921 16.4965L19.7132 21.9909L25.2921 27.4853C25.872 28.0564 25.872 28.9824 25.2921 29.5535C24.7122 30.1246 23.7721 30.1246 23.1922 29.5535L16.5633 23.025Z" fill="white"/>\n' +
        '</svg>', '<svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44" fill="none">\n' +
        '<rect width="44" height="44" rx="22" transform="matrix(-1 0 0 1 44 0)" fill="#EB6025"/>\n' +
        '<path fill-rule="evenodd" clip-rule="evenodd" d="M27.4367 23.025C28.0166 22.4539 28.0166 21.5279 27.4367 20.9568L20.8078 14.4283C20.2279 13.8572 19.2878 13.8572 18.7079 14.4283C18.128 14.9994 18.128 15.9254 18.7079 16.4965L24.2868 21.9909L18.7079 27.4853C18.128 28.0564 18.128 28.9824 18.7079 29.5535C19.2878 30.1246 20.2279 30.1246 20.8078 29.5535L27.4367 23.025Z" fill="white"/>\n' +
        '</svg>'],
        responsive: {
            0: {
                margin:12,
                center: true,
                nav:true,
                startPosition: 1,
            },
            461: {
                margin:12,
                center: false,
                nav:false,
            },
            1121: {
                margin:24,
                center: false,
                nav:false,
            },
            1261: {
                margin:24,
                center: true,
                nav:false,
            }
        }
    });

    $('.before-after-cards__slider').owlCarousel({
        loop: false,
        autoWidth: true,
        margin:20,
        center: true,
        dots:false,

        nav:false,
        // navText: ['<svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44" fill="none">\n' +
        // '<rect width="44" height="44" rx="22" fill="#EB6025"/>\n' +
        // '<path fill-rule="evenodd" clip-rule="evenodd" d="M16.5633 23.025C15.9834 22.4539 15.9834 21.5279 16.5633 20.9568L23.1922 14.4283C23.7721 13.8572 24.7122 13.8572 25.2921 14.4283C25.872 14.9994 25.872 15.9254 25.2921 16.4965L19.7132 21.9909L25.2921 27.4853C25.872 28.0564 25.872 28.9824 25.2921 29.5535C24.7122 30.1246 23.7721 30.1246 23.1922 29.5535L16.5633 23.025Z" fill="white"/>\n' +
        // '</svg>', '<svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" viewBox="0 0 44 44" fill="none">\n' +
        // '<rect width="44" height="44" rx="22" transform="matrix(-1 0 0 1 44 0)" fill="#EB6025"/>\n' +
        // '<path fill-rule="evenodd" clip-rule="evenodd" d="M27.4367 23.025C28.0166 22.4539 28.0166 21.5279 27.4367 20.9568L20.8078 14.4283C20.2279 13.8572 19.2878 13.8572 18.7079 14.4283C18.128 14.9994 18.128 15.9254 18.7079 16.4965L24.2868 21.9909L18.7079 27.4853C18.128 28.0564 18.128 28.9824 18.7079 29.5535C19.2878 30.1246 20.2279 30.1246 20.8078 29.5535L27.4367 23.025Z" fill="white"/>\n' +
        // '</svg>'],
        responsive: {
            0: {
                margin:10,
                center: false,
                dots:true,
            },
            561: {
                margin:20,
                center: true,
                dots:false,
            },
            1261: {
                margin:20,
                center: true,
                dots:false,
            }
        }
    });
    //---------


    //custom scrollbar
    $(window).on("load",function(){
        $(".custom-scroll").mCustomScrollbar({
            theme:"bober-orange",
        });
    });


    //---------
    //faq-block

    faqToggles = $('.faq-block__item__head');
    $('.faq-block__item:first-child').toggleClass('js-faq-item-open'); //Первый item открыт
    $('.faq-block__item:first-child').find('.faq-block__item__content').slideToggle(200); //Первый item открыт
    faqToggles.click(function () {
        $(this).parents('.faq-block__item').toggleClass('js-faq-item-open');
        $(this).parents('.faq-block__item').find('.faq-block__item__content').slideToggle(200);
    });

    faqBtnOpenAll = $('.faq-block__btn--js');
    faqBtnOpenAll.click(function () {
        if($(this).hasClass('faq-block__btn--open-all')) {
            $(this).parents('.faq-block__section').find('.faq-block__item').addClass('js-faq-item-open');
            $(this).parents('.faq-block__section').find('.faq-block__item__content').slideDown(200);
            $(this).text('Закрыть все');
            $(this).removeClass('faq-block__btn--open-all');
        } else {
            $(this).parents('.faq-block__section').find('.faq-block__item').removeClass('js-faq-item-open');
            $(this).parents('.faq-block__section').find('.faq-block__item__content').slideUp(200);
            $(this).text('Открыть все');
            $(this).addClass('faq-block__btn--open-all');
        }
    });
    //---------

    //popup
    //open popup
    $('.btn-modal-open--1').on('click', function(event){
        event.preventDefault();
        $('.modal-block__1').addClass('modal-open');
        $('.modal-blur-wrapper').addClass('modal-open');
    });
    $('.btn-modal-open--call').on('click', function(event){
        event.preventDefault();
        $('.modal-block__call').addClass('modal-open');
        $('.modal-blur-wrapper').addClass('modal-open');
    });

    //close popup - .close-modal
    $('.modal-block').on('click', function(event){
        if( event.target.closest('.close-modal') ) {
            event.preventDefault();
            $(this).removeClass('modal-open');
            $('.modal-blur-wrapper').removeClass('modal-open');
        }
    });
    //close popup - ESC
    $(document).keyup(function(event){
        if(event.which=='27'){
            $('.modal-block').removeClass('modal-open');
            $('.modal-blur-wrapper').removeClass('modal-open');
        }
    });
    //close popup - .modal-blur-wrapper
    $('.modal-blur-wrapper').on('click', function(event){
        event.preventDefault();
        $('.modal-block').removeClass('modal-open');
        $('.modal-blur-wrapper').removeClass('modal-open');
    });
    //---------



    // //проверка всех слайдеров
    // function catalog_slider_check() {
    //     $('.slider-default').each(function() {
    //         var $this = $(this);
    //         var size_windows = $(window).width();
    //         var catalog_slider_item_count = $this.find(".slider-default__item").length; // Количество слайдов в текущем слайдере
    //         var catalog_slider_item_width = $this.find(".slider-default__item").outerWidth(true); // Размер одного слайда в текущем слайдере
    //         var catalog_slider_total = catalog_slider_item_count * catalog_slider_item_width; // Размер текущего слайдера
    //
    //         if (size_windows <= catalog_slider_total) {
    //             catalog_slider_on($this); // Запуск инициализации слайдера для текущего элемента
    //         }
    //     });
    // }
    // //иниц слайдера
    // function catalog_slider_on($slider) {
    //     $.each($slider,function(index,value){
    //         // console.log('Индекс: ' + index + '; Значение: ' + value);
    //         $(value).owlCarousel({
    //             loop: true,
    //             margin: 0,
    //             items:5,
    //             autoWidth: true,
    //             margin:12,
    //             center:true,
    //         });
    //     })
    //     // $(value).owlCarousel({
    //     //     loop: true,
    //     //     margin: 0,
    //     //     responsiveClass: true,
    //     //     // autoWidth: true,
    //     // });
    // }
    // // Проверка при изменении размера окна браузера
    // $(window).resize(function() {
    //     catalog_slider_check();
    // });
    // //Первая проверка при загрузке страницы
    // catalog_slider_check();

});
